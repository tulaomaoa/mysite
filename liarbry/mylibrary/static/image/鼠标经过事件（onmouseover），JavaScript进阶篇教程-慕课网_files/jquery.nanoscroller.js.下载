!function(h){return"function"==typeof define&&define.amd?define(["jquery"],function(c){return h(c,window,document)}):h(jQuery,window,document)}(function(h,c,a){"use strict";var g,v,S,T,y,b,w,$,H,C,O,A,E,Y,D,M,N,F,R,B,P,V,I,k,z,j,W,X,Q,U,G;I={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},F="scrollbar",N="scroll",H="mousedown",C="mouseenter",O="mousemove",E="mousewheel",A="mouseup",M="resize",y="drag",b="enter",B="up",D="panedown",S="DOMMouseScroll",T="down",P="wheel",w="keydown",$="keyup",R="touchmove",g="Microsoft Internet Explorer"===c.navigator.appName&&/msie 7./i.test(c.navigator.appVersion)&&c.ActiveXObject,v=null,W=c.requestAnimationFrame,V=c.cancelAnimationFrame,Q=a.createElement("div").style,G=function(){var i,h,c,a,g,v;for(a=["t","webkitT","MozT","msT","OT"],i=g=0,v=a.length;v>g;i=++g)if(c=a[i],h=a[i]+"ransform",h in Q)return a[i].substr(0,a[i].length-1);return!1}(),U=function(h){return G===!1?!1:""===G?h:G+h.charAt(0).toUpperCase()+h.substr(1)},X=U("transform"),z=X!==!1,k=function(){var h,c,g;return h=a.createElement("div"),c=h.style,c.position="absolute",c.width="100px",c.height="100px",c.overflow=N,c.top="-9999px",a.body.appendChild(h),g=h.offsetWidth-h.clientWidth,a.body.removeChild(h),g},j=function(){var h,a,g;return a=c.navigator.userAgent,(h=/(?=.+Mac OS X)(?=.+Firefox)/.test(a))?(g=/Firefox\/\d{2}\./.exec(a),g&&(g=g[0].replace(/\D+/g,"")),h&&+g>23):!1},Y=function(){function w(g,S){this.el=g,this.options=S,v||(v=k()),this.$el=h(this.el),this.doc=h(this.options.documentContext||a),this.win=h(this.options.windowContext||c),this.body=this.doc.find("body"),this.$content=this.$el.children("."+S.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return w.prototype.preventScrolling=function(e,h){if(this.isActive)if(e.type===S)(h===T&&e.originalEvent.detail>0||h===B&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===E){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(h===T&&e.originalEvent.wheelDelta<0||h===B&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},w.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},w.prototype.updateScrollValues=function(){var h,c;h=this.content,this.maxScrollTop=h.scrollHeight-h.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=h.scrollTop,c=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==c&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:c}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},w.prototype.setOnScrollStyles=function(){var h;z?(h={},h[X]="translate(0, "+this.sliderTop+"px)"):h={top:this.sliderTop},W?(V&&this.scrollRAF&&V(this.scrollRAF),this.scrollRAF=W(function(c){return function(){return c.scrollRAF=null,c.slider.css(h)}}(this))):this.slider.css(h)},w.prototype.createEvents=function(){this.events={down:function(h){return function(e){return h.isBeingDragged=!0,h.offsetY=e.pageY-h.slider.offset().top,h.slider.is(e.target)||(h.offsetY=0),h.pane.addClass("active"),h.doc.bind(O,h.events[y]).bind(A,h.events[B]),h.body.bind(C,h.events[b]),!1}}(this),drag:function(h){return function(e){return h.sliderY=e.pageY-h.$el.offset().top-h.paneTop-(h.offsetY||.5*h.sliderHeight),h.scroll(),h.contentScrollTop>=h.maxScrollTop&&h.prevScrollTop!==h.maxScrollTop?h.$el.trigger("scrollend"):0===h.contentScrollTop&&0!==h.prevScrollTop&&h.$el.trigger("scrolltop"),!1}}(this),up:function(h){return function(){return h.isBeingDragged=!1,h.pane.removeClass("active"),h.doc.unbind(O,h.events[y]).unbind(A,h.events[B]),h.body.unbind(C,h.events[b]),!1}}(this),resize:function(h){return function(){h.reset()}}(this),panedown:function(h){return function(e){return h.sliderY=(e.offsetY||e.originalEvent.layerY)-.5*h.sliderHeight,h.scroll(),h.events.down(e),!1}}(this),scroll:function(h){return function(e){h.updateScrollValues(),h.isBeingDragged||(h.iOSNativeScrolling||(h.sliderY=h.sliderTop,h.setOnScrollStyles()),null!=e&&(h.contentScrollTop>=h.maxScrollTop?(h.options.preventPageScrolling&&h.preventScrolling(e,T),h.prevScrollTop!==h.maxScrollTop&&h.$el.trigger("scrollend")):0===h.contentScrollTop&&(h.options.preventPageScrolling&&h.preventScrolling(e,B),0!==h.prevScrollTop&&h.$el.trigger("scrolltop"))))}}(this),wheel:function(h){return function(e){var c;if(null!=e)return c=e.delta||e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail||e.originalEvent&&-e.originalEvent.detail,c&&(h.sliderY+=-c/3),h.scroll(),!1}}(this),enter:function(h){return function(e){var c;if(h.isBeingDragged)return 1!==(e.buttons||e.which)?(c=h.events)[B].apply(c,arguments):void 0}}(this)}},w.prototype.addEvents=function(){var h;this.removeEvents(),h=this.events,this.options.disableResize||this.win.bind(M,h[M]),this.iOSNativeScrolling||(this.slider.bind(H,h[T]),this.pane.bind(H,h[D]).bind(""+E+" "+S,h[P])),this.$content.bind(""+N+" "+E+" "+S+" "+R,h[N])},w.prototype.removeEvents=function(){var h;h=this.events,this.win.unbind(M,h[M]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+N+" "+E+" "+S+" "+R,h[N])},w.prototype.generate=function(){var h,a,g,S,T,y,b;return S=this.options,y=S.paneClass,b=S.sliderClass,h=S.contentClass,(T=this.$el.children("."+y)).length||T.children("."+b).length||this.$el.append('<div class="'+y+'"><div class="'+b+'" /></div>'),this.pane=this.$el.children("."+y),this.slider=this.pane.find("."+b),0===v&&j()?(g=c.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),a={right:-14,paddingRight:+g+14}):v&&(a={right:-v},this.$el.addClass("has-scrollbar")),null!=a&&this.$content.css(a),this},w.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},w.prototype.reset=function(){var h,c,a,S,T,y,b,w,$,H,C,O;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),h=this.content,S=h.style,T=S.overflowY,g&&this.$content.css({height:this.$content.height()}),c=h.scrollHeight+v,H=parseInt(this.$el.css("max-height"),10),H>0&&(this.$el.height(""),this.$el.height(h.scrollHeight>H?H:h.scrollHeight)),b=this.pane.outerHeight(!1),$=parseInt(this.pane.css("top"),10),y=parseInt(this.pane.css("bottom"),10),w=b+$+y,O=Math.round(w/c*w),O<this.options.sliderMinHeight?O=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&O>this.options.sliderMaxHeight&&(O=this.options.sliderMaxHeight),T===N&&S.overflowX!==N&&(O+=v),this.maxSliderTop=w-O,this.contentHeight=c,this.paneHeight=b,this.paneOuterHeight=w,this.sliderHeight=O,this.paneTop=$,this.slider.height(O),this.events.scroll(),this.pane.show(),this.isActive=!0,h.scrollHeight===h.clientHeight||this.pane.outerHeight(!0)>=h.scrollHeight&&T!==N?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===h.scrollHeight&&T===N?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),a=this.$content.css("position"),("static"===a||"relative"===a)&&(C=parseInt(this.$content.css("right"),10),C&&this.$content.css({right:"",marginRight:C})),this)},w.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},w.prototype.scrollBottom=function(h){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-h).trigger(E),this.stop().restore(),this):void 0},w.prototype.scrollTop=function(h){return this.isActive?(this.$content.scrollTop(+h).trigger(E),this.stop().restore(),this):void 0},w.prototype.scrollTo=function(c){if(this.isActive){var a=this.$el.find(c).get(0);return(a.offsetTop<0||a.offsetTop>h(".nano-content").height())&&this.scrollTop(a.offsetTop),this}},w.prototype.stop=function(){return V&&this.scrollRAF&&(V(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},w.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),g&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},w.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass("flashed"),setTimeout(function(h){return function(){h.pane.removeClass("flashed")}}(this),this.options.flashDelay),this):void 0},w}(),h.fn.nanoScroller=function(c){return this.each(function(){var a,g;if((g=this.nanoscroller)||(a=h.extend({},I,c),this.nanoscroller=g=new Y(this,a)),c&&"object"==typeof c){if(h.extend(g.options,c),null!=c.scrollBottom)return g.scrollBottom(c.scrollBottom);if(null!=c.scrollTop)return g.scrollTop(c.scrollTop);if(c.scrollTo)return g.scrollTo(c.scrollTo);if("bottom"===c.scroll)return g.scrollBottom(0);if("top"===c.scroll)return g.scrollTop(0);if(c.scroll&&c.scroll instanceof h)return g.scrollTo(c.scroll);if(c.stop)return g.stop();if(c.destroy)return g.destroy();if(c.flash)return g.flash()}return g.reset()})},h.fn.nanoScroller.Constructor=Y});